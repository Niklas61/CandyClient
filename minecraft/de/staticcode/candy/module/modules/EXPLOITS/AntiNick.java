package de.staticcode.candy.module.modules.EXPLOITS;

import de.staticcode.candy.gui.components.GuiComponent;
import de.staticcode.candy.module.Module;
import de.staticcode.candy.module.category.Category;
import net.minecraft.entity.player.EntityPlayer;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

public class AntiNick extends Module {

    private final List< EntityPlayer > entitysInWorld = new ArrayList<> ( );

    private float delay;

    private final GuiComponent valueDelay = new GuiComponent ( "Delay" , this , 20d , 1d , 5d );

    public static Map< String, String > Usernames = new HashMap<> ( );
    public static Map< EntityPlayer, String > realNames = new HashMap<> ( );

    public AntiNick ( ) {
        super ( "AntiNick" , Category.EXPLOITS );
    }

    @Override
    public void onDisable ( ) {
        this.entitysInWorld.clear ( );
        Usernames.clear ( );
        realNames.clear ( );
        this.delay = 0.0f;
        super.onDisable ( );
    }

    @Override
    public void onEnable ( ) {
        this.entitysInWorld.clear ( );
        Usernames.clear ( );
        realNames.clear ( );

        this.delay = 0.0f;

        super.onEnable ( );
    }

    @Override
    public void onUpdate ( ) {


        for ( Object e : mc.theWorld.playerEntities ) {
            if (e != null && e instanceof EntityPlayer) {

                if (!this.entitysInWorld.contains ( e )) {
                    this.delay += 0.50f;

                    if (!realNames.containsKey ( e ))
                        realNames.put ( ( EntityPlayer ) e , ( ( EntityPlayer ) e ).getName ( ) );

                    String realName = realNames.get ( e );

                    if (this.delay >= this.valueDelay.getCurrent ( )) {

                        if (realName.equalsIgnoreCase ( ( ( EntityPlayer ) e ).getName ( ) )) {
                            this.delay = 0.0f;
                            return;
                        }

                        AntiNick.this.entitysInWorld.add ( ( EntityPlayer ) e );
                        Usernames.put ( ( ( EntityPlayer ) e ).getName ( ) , realName );

                        this.delay = 0.0f;
                    }

                }
            }
        }


        super.onUpdate ( );
    }

}
