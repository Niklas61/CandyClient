package de.staticcode.candy.module.modules.EXPLOITS;

import de.staticcode.candy.gui.components.GuiComponent;
import de.staticcode.candy.module.Module;
import de.staticcode.candy.module.category.Category;
import de.staticcode.candy.module.modules.COMBAT.Killaura;
import de.staticcode.candy.utils.Timings;
import net.minecraft.entity.Entity;

public class FakeLagg extends Module {

    private static boolean fakeLagging;

    protected GuiComponent laggDelay = new GuiComponent ( "Lagg-Delay" , this , 3500D , 100D , 100D );
    protected GuiComponent packetDelay = new GuiComponent ( "Packet-Delay" , this , 350D , 20D , 20D );

    protected Timings timings = new Timings ( );
    protected Entity entity = null;

    public FakeLagg ( ) {
        super ( "FakeLagg" , Category.EXPLOITS );
    }

    @Override
    public void onDisable ( ) {
        this.timings.resetTimings ( );
        setFakeLagging ( false );
        this.resetEntity ( );
        super.onDisable ( );
    }

    @Override
    public void onUpdate ( ) {
        final long laggDelay = ( long ) this.laggDelay.getCurrent ( );

        if (Killaura.underAttack == null && this.entity != null) {
            this.resetEntity ( );
        }

        setFakeLagging ( this.timings.hasReached ( laggDelay ) );

        if (isFakeLagging ( )) {
//
//            if (Killaura.underAttack != null && Killaura.underAttack instanceof EntityPlayer) {
//                Candy.sendChat ( "spawn entity" );
//                EntityPlayer entityPlayer = ( EntityPlayer ) Killaura.underAttack;
//                this.entity = new EntityOtherPlayerMP ( this.mc.theWorld , entityPlayer.getGameProfile ( ) );
//
//
//                this.entity.posX = entityPlayer.getLaggX ( );
//                this.entity.posY = entityPlayer.getLaggY ( );
//                this.entity.posZ = entityPlayer.getLaggZ ( );
//            }

            this.timings.resetTimings ( );
        } else {
//            this.resetEntity ( );
        }


        super.onUpdate ( );
    }

    private void resetEntity ( ) {
        if (this.entity != null) {
            this.entity.setDead ( );
            this.entity = null;
        }
    }

    public Entity getEntity ( ) {
        return entity;
    }

    public void setEntity ( Entity entity ) {
        this.entity = entity;
    }

    public static boolean isFakeLagging ( ) {
        return fakeLagging;
    }

    public static void setFakeLagging ( boolean fakeLagging ) {
        FakeLagg.fakeLagging = fakeLagging;
    }
}
